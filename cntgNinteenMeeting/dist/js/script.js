function loadImg(){if(1==sessionStorage.getItem("img_reload"))return document.querySelectorAll(".load_progress")[0].style.width="100%",document.querySelectorAll(".img_loader")[0].style.display="none",void showIndexLetter();var e=new ImagesLoader;e.loadImages(["index/cloud.png","index/index_bg.png","sub/alert.png","sub/book.png","sub/button.png","sub/mont.png","sub/word.png","map/bg_1.png","map/bg_2.png","ask_1/tree.png","ask_1/base.png","ask_1/door.png","ask_2/bg.png","ask_3/bg.png","ask_4/pic.png","ask_4/bg.png","ask_4/pillar.png","ask_5/pic.png","ask_6/pic.png","ask_6/bg.png","score/a.png","score/b.png","score/c.png"],"img/"),e.complete(function(){document.querySelectorAll(".img_loader")[0].style.display="none",sessionStorage.setItem("img_reload","1"),showIndexLetter()}),e.process(function(){document.querySelectorAll(".load_progress")[0].style.width=this.processNum+"%"}),e.start()}function showIndexLetter(){var e=window.location.hash;if(!e||"#vslide1"===e)var t=document.querySelectorAll(".index_title_word_eg")[0],n=document.querySelectorAll(".index_title_word")[0],o=0,s=setInterval(function(){n.innerHTML=t.innerHTML.substring(0,o),o++,n.innerHTML===t.innerHTML&&(swiperV.slideTo(1,800,!0),clearInterval(s))},200)}function initSwiperV(){swiperV=new Swiper(".swiper-container-v",{direction:"vertical",slidesPerView:1,spaceBetween:0,mousewheelControl:!0,autoplay:0,autoHeight:!0,lazyLoadingOnTransitionStart:!0,lazyLoading:!0,hashnav:!0,noSwiping:!0,noSwipingClass:"stop-swiping",onInit:function(e){getActiveIndex(e),swiperAnimateCache(e),swiperAnimate(e)},onTouchEnd:function(e){getActiveIndex(e)},onSlideChangeEnd:function(e){swiperAnimate(e)}})}function initSwiperH(){swiperH=new Swiper(".swiper-container-h",{spaceBetween:0,freeMode:!0,slidesPerView:"auto"})}function configWXShare(){var e={title:"拼知识,你怕了吗? | Are you a language maestro?",desc:'Take "Xi\'s quiz" on quotes! | 如果习主席出一份名言小测验,你能答几分?',imgUrl:"https://news.cgtn.com/xiquotequiz-19thcpc/img/logo.png",link:window.location.href.split("#")[0]},t={debug:!1,appId:"wxd61ff47456d31b8e",timestamp:Date.now(),nonceStr:"",signature:"",jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo"]},n="https://wechat.cgtn.com/socialweb/social/weixin/getKeys.do?url="+encodeURIComponent(window.location.href.split("#")[0]);$.ajax({url:n,type:"GET",dataType:"json",contentType:"application/json",success:function(n){t.timestamp=n.data.timestamp,t.nonceStr=n.data.nonceStr,t.signature=n.data.signature,wx.config(t),wx.ready(function(){wx.onMenuShareTimeline(e),wx.onMenuShareAppMessage(e),wx.onMenuShareQQ(e),wx.onMenuShareWeibo(e)}),wx.error(function(e){alert("wechat init fail"+JSON.stringify(res))})},error:function(e){console.log(e)}})}function changeAto1(e,t){switch(e){case"a":return document.querySelectorAll(t)[0];case"b":return document.querySelectorAll(t)[1];case"c":return document.querySelectorAll(t)[2];case"d":return document.querySelectorAll(t)[3]}}function initStorage(){window.location.hash.replace("#vslide","");var e=window.sessionStorage.getItem("wy_score");if(e){var t=JSON.parse(e);6==(maxVisitedClas=t.maxClass)&&(document.querySelectorAll(".map_prompt_1")[0].style.display="none",document.querySelectorAll(".map_prompt_2")[0].style.display="none"),score_mun=t.score,changeProgress(maxVisitedClas+1);for(var n="",o=0;o<score_mun.length;o++)score_mun[o]&&(n=".ask"+(o+1)+"_a",chooseItem(changeAto1(score_mun[o],n),n,o+1,score_mun[o],!0))}else{if(!window.location.hash)return;changeProgress(1)}}function getActiveIndex(e){var t=setTimeout(function(){var n=e.realIndex;0==n?($(".cloud").css("-webkit-animation-play-state","running"),$(".cloud").css("animation-play-state","running")):1==n&&($(".cloud").css("-webkit-animation-play-state","paused"),$(".cloud").css("animation-play-state","paused")),clearTimeout(t)},100)}function toMap(){swiperV.slideTo(2,0,!1)}function toClass(e,t){if(e>3&&!score_mun[e-4])sub_toggleShow(".map_alert_1");else{var n=document.querySelectorAll(".map_alert_1")[0],o=document.querySelectorAll(".map_alert_2")[0];n.classList.contains("none")||n.classList.toggle("none"),o.classList.contains("none")||o.classList.toggle("none");var s=".ask"+(e-2)+"_question";e>=3&&e<9&&($(".ask"+(e-2)+"_ani").css("animation-play-state","running"),$(".ask"+(e-2)+"_ani").css("-webkit-animation-play-state","running")),5==e?($(".road_width_2").css("transition","width 1s linear 1s"),$(".road_width_2").css("-webkit-transition","width 1s linear 1s")):($(".road_width_2").css("transition","width 1s linear"),$(".road_width_2").css("-webkit-transition","width 1s linear"));var a=setTimeout(function(){swiperV.slideTo(e,0,!0),$(s).css("transition","all 1s ease"),$(s).css("-webkit-transition","all 1s ease"),clearTimeout(a)},500)}}function sub_toggleShow(e){document.querySelectorAll(e)[0].classList.toggle("none")}function chooseItem(e,t,n,o,s){for(var a=document.querySelectorAll(t),c=0;c<a.length;c++)a[c].style.color="#2e374e";e.style.color="#ff6c37",score_mun[n-1]=o,n>maxVisitedClas&&(maxVisitedClas=n),6==n&&(document.querySelectorAll(".map_prompt_1")[0].style.display="block",document.querySelectorAll(".map_prompt_2")[0].style.display="block",document.querySelectorAll(".map_getScore")[0].style.display="block",document.querySelectorAll(".map_change")[0].style.display="block");document.querySelectorAll(".ask"+n+"_ani")[0];$(".ask"+n+"_ani").css("animation-play-state","paused"),$(".ask"+n+"_ani").css("-webkit-animation-play-state","paused");var i={maxClass:maxVisitedClas,score:score_mun};if(window.sessionStorage.setItem("wy_score",JSON.stringify(i)),!s)var l=setTimeout(function(){toMap(2),changeProgress(n+1),clearTimeout(l)},600)}function changeProgress(e){if(!(e<maxVisitedClas+1)){var t=document.querySelectorAll(".road_width_1")[0],n=document.querySelectorAll(".road_width_2")[0];switch(e){case 1:t.style.width="19.3vw";break;case 2:t.style.width="38.7vw";break;case 3:t.style.width="74.47vw";break;case 4:t.style.width="100vw",n.style.width="11.85vw";break;case 5:t.style.width="100vw",n.style.width="31vw";break;case 6:t.style.width="100vw",n.style.width="68.8vw";break;case 7:t.style.width="100vw",n.style.width="79.8vw"}}}function getScore(){toClass(9);for(var e=0,t=["d","a","b","c","a","b"],n=0;n<score_mun.length;n++)score_mun[n]==t[n]&&(e+=1);6==e?document.querySelectorAll(".score_a")[0].style.display="block":e<6&&e>=4?document.querySelectorAll(".score_b")[0].style.display="block":document.querySelectorAll(".score_c")[0].style.display="block",window.sessionStorage.clear()}window.onload=function(){loadImg(),initSwiperV(),initSwiperH(),initStorage(),configWXShare(),document.addEventListener("WeixinJSBridgeReady",function(){document.getElementById("music").play()},!1)};var swiperV=null,swiperH=null,maxVisitedClas=0,mapHash=0,score_mun=[0,0,0,0,0,0];$(window).on("hashchange",function(){var e=document.querySelectorAll(".swiper-button-next")[0],t=window.location.hash.replace("#vslide","");if(1==t&&showIndexLetter(),e.style.display=2==t?"block":"none",3==t){if(mapHash)return;mapHash=1,changeProgress(1)}}),document.querySelectorAll(".sub_click_area")[0].addEventListener("touchend",function(){sub_toggleShow(".sub_alert")},!1),document.querySelectorAll(".sub_back")[0].addEventListener("touchend",function(){sub_toggleShow(".sub_alert")},!1),document.querySelectorAll(".map_class")[0].addEventListener("touchend",function(){toClass(3,"top")},!1),document.querySelectorAll(".map_class")[1].addEventListener("touchend",function(){toClass(4)},!1),document.querySelectorAll(".map_class")[2].addEventListener("touchend",function(){toClass(5)},!1),document.querySelectorAll(".map_class")[3].addEventListener("touchend",function(){toClass(6)},!1),document.querySelectorAll(".map_class")[4].addEventListener("touchend",function(){toClass(7)},!1),document.querySelectorAll(".map_class")[5].addEventListener("touchend",function(){toClass(8)},!1),document.querySelectorAll(".map_getScore")[0].addEventListener("touchend",getScore,!1),document.querySelectorAll(".map_change")[0].addEventListener("touchend",function(){sub_toggleShow(".map_alert_2")},!1),document.querySelectorAll(".map_alert_2")[0].addEventListener("touchend",function(){sub_toggleShow(".map_alert_2")},!1),document.querySelectorAll(".map_alert_3")[0].addEventListener("touchend",function(){sub_toggleShow(".map_alert_3")},!1),document.querySelectorAll(".map_alert1_close")[0].addEventListener("touchend",function(){sub_toggleShow(".map_alert_1")},!1),document.querySelectorAll(".ask1_a")[0].addEventListener("touchend",function(){chooseItem(this,".ask1_a",1,"a")},!1),document.querySelectorAll(".ask1_a")[1].addEventListener("touchend",function(){chooseItem(this,".ask1_a",1,"b")},!1),document.querySelectorAll(".ask1_a")[2].addEventListener("touchend",function(){chooseItem(this,".ask1_a",1,"c")},!1),document.querySelectorAll(".ask1_a")[3].addEventListener("touchend",function(){chooseItem(this,".ask1_a",1,"d")},!1),document.querySelectorAll(".ask2_a")[0].addEventListener("touchend",function(){chooseItem(this,".ask2_a",2,"a")},!1),document.querySelectorAll(".ask2_a")[1].addEventListener("touchend",function(){chooseItem(this,".ask2_a",2,"b")},!1),document.querySelectorAll(".ask2_a")[2].addEventListener("touchend",function(){chooseItem(this,".ask2_a",2,"c")},!1),document.querySelectorAll(".ask2_a")[3].addEventListener("touchend",function(){chooseItem(this,".ask2_a",2,"d")},!1),document.querySelectorAll(".ask3_a")[0].addEventListener("touchend",function(){chooseItem(this,".ask3_a",3,"a")},!1),document.querySelectorAll(".ask3_a")[1].addEventListener("touchend",function(){chooseItem(this,".ask3_a",3,"b")},!1),document.querySelectorAll(".ask3_a")[2].addEventListener("touchend",function(){chooseItem(this,".ask3_a",3,"c")},!1),document.querySelectorAll(".ask3_a")[3].addEventListener("touchend",function(){chooseItem(this,".ask3_a",3,"d")},!1),document.querySelectorAll(".ask4_a")[0].addEventListener("touchend",function(){chooseItem(this,".ask4_a",4,"a")},!1),document.querySelectorAll(".ask4_a")[1].addEventListener("touchend",function(){chooseItem(this,".ask4_a",4,"b")},!1),document.querySelectorAll(".ask4_a")[2].addEventListener("touchend",function(){chooseItem(this,".ask4_a",4,"c")},!1),document.querySelectorAll(".ask4_a")[3].addEventListener("touchend",function(){chooseItem(this,".ask4_a",4,"d")},!1),document.querySelectorAll(".ask5_a")[0].addEventListener("touchend",function(){chooseItem(this,".ask5_a",5,"a")},!1),document.querySelectorAll(".ask5_a")[1].addEventListener("touchend",function(){chooseItem(this,".ask5_a",5,"b")},!1),document.querySelectorAll(".ask5_a")[2].addEventListener("touchend",function(){chooseItem(this,".ask5_a",5,"c")},!1),document.querySelectorAll(".ask5_a")[3].addEventListener("touchend",function(){chooseItem(this,".ask5_a",5,"d")},!1),document.querySelectorAll(".ask6_a")[0].addEventListener("touchend",function(){chooseItem(this,".ask6_a",6,"a")},!1),document.querySelectorAll(".ask6_a")[1].addEventListener("touchend",function(){chooseItem(this,".ask6_a",6,"b")},!1),document.querySelectorAll(".ask6_a")[2].addEventListener("touchend",function(){chooseItem(this,".ask6_a",6,"c")},!1),document.querySelectorAll(".ask6_a")[3].addEventListener("touchend",function(){chooseItem(this,".ask6_a",6,"d")},!1);